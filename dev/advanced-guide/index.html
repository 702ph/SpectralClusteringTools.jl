<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Spectral Clustering: Advanced Guide · SpectralClusteringTools.jl</title><meta name="title" content="Spectral Clustering: Advanced Guide · SpectralClusteringTools.jl"/><meta property="og:title" content="Spectral Clustering: Advanced Guide · SpectralClusteringTools.jl"/><meta property="twitter:title" content="Spectral Clustering: Advanced Guide · SpectralClusteringTools.jl"/><meta name="description" content="Documentation for SpectralClusteringTools.jl."/><meta property="og:description" content="Documentation for SpectralClusteringTools.jl."/><meta property="twitter:description" content="Documentation for SpectralClusteringTools.jl."/><meta property="og:url" content="https://702ph.github.io/SpectralClusteringTools.jl/advanced-guide/"/><meta property="twitter:url" content="https://702ph.github.io/SpectralClusteringTools.jl/advanced-guide/"/><link rel="canonical" href="https://702ph.github.io/SpectralClusteringTools.jl/advanced-guide/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">SpectralClusteringTools.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Spectral Clustering: Advanced Guide</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Spectral Clustering: Advanced Guide</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/702ph/SpectralClusteringTools.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/702ph/SpectralClusteringTools.jl/blob/main/docs/src/advanced-guide.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Spectral-Clustering:-Advanced-Guide"><a class="docs-heading-anchor" href="#Spectral-Clustering:-Advanced-Guide">Spectral Clustering: Advanced Guide</a><a id="Spectral-Clustering:-Advanced-Guide-1"></a><a class="docs-heading-anchor-permalink" href="#Spectral-Clustering:-Advanced-Guide" title="Permalink"></a></h1><h2 id="1.-Introduction"><a class="docs-heading-anchor" href="#1.-Introduction">1. Introduction</a><a id="1.-Introduction-1"></a><a class="docs-heading-anchor-permalink" href="#1.-Introduction" title="Permalink"></a></h2><h3 id="1.1-What-is-Spectral-Clustering?"><a class="docs-heading-anchor" href="#1.1-What-is-Spectral-Clustering?">1.1 What is Spectral Clustering?</a><a id="1.1-What-is-Spectral-Clustering?-1"></a><a class="docs-heading-anchor-permalink" href="#1.1-What-is-Spectral-Clustering?" title="Permalink"></a></h3><p>Spectral Clustering is a clustering method that utilizes eigenvalue decomposition of graphs to identify clusters in data. Unlike traditional clustering algorithms such as k-means, Spectral Clustering can capture nonlinear structures in the data.</p><p>The paper <em>&quot;A Tutorial on Spectral Clustering&quot;</em> provides a comprehensive theoretical foundation for Spectral Clustering, outlining the process as follows:</p><ol><li>Construct a similarity graph</li><li>Compute the graph Laplacian</li><li>Perform eigenvalue decomposition</li><li>Embed data into a lower-dimensional space</li><li>Apply clustering (typically using k-means)</li></ol><p>This tutorial will provide a guide on how to implement Spectral Clustering.</p><p><strong>Reference Papers:</strong></p><ul><li><a href="https://arxiv.org/abs/0711.0189">A Tutorial on Spectral Clustering</a></li><li><a href="https://proceedings.neurips.cc/paper_files/paper/2004/file/40173ea48d9567f1f393b20c855bb40b-Paper.pdf">Self-Tuning Spectral Clustering</a></li></ul><h2 id="2.-Parameter-Settings-(Parameter-Types)"><a class="docs-heading-anchor" href="#2.-Parameter-Settings-(Parameter-Types)">2. Parameter Settings (Parameter Types)</a><a id="2.-Parameter-Settings-(Parameter-Types)-1"></a><a class="docs-heading-anchor-permalink" href="#2.-Parameter-Settings-(Parameter-Types)" title="Permalink"></a></h2><h3 id="2.1-SpectralClusteringParams"><a class="docs-heading-anchor" href="#2.1-SpectralClusteringParams">2.1 SpectralClusteringParams</a><a id="2.1-SpectralClusteringParams-1"></a><a class="docs-heading-anchor-permalink" href="#2.1-SpectralClusteringParams" title="Permalink"></a></h3><p><strong>Overview:</strong> Defines the parameters for similarity graphs used in Spectral Clustering.</p><pre><code class="language-julia hljs">struct SpectralClusteringParams
    graph_type::Symbol  # :epsilon, :knn, :fully_connected
    k::Int  # Number of neighbors for k-NN graph
    ε::Float64  # Threshold for ε-neighborhood graph
    σ::Float64  # Scale for Gaussian similarity
end</code></pre><h3 id="2.2-SelfTuningParams"><a class="docs-heading-anchor" href="#2.2-SelfTuningParams">2.2 SelfTuningParams</a><a id="2.2-SelfTuningParams-1"></a><a class="docs-heading-anchor-permalink" href="#2.2-SelfTuningParams" title="Permalink"></a></h3><p><strong>Overview:</strong> Defines parameters for Self-Tuning Spectral Clustering.</p><pre><code class="language-julia hljs">struct SelfTuningParams
    k::Int  # Number of nearest neighbors
    σ::Float64  # Scale for Gaussian kernel
end</code></pre><h3 id="2.3-NormalizedCutsParams"><a class="docs-heading-anchor" href="#2.3-NormalizedCutsParams">2.3 NormalizedCutsParams</a><a id="2.3-NormalizedCutsParams-1"></a><a class="docs-heading-anchor-permalink" href="#2.3-NormalizedCutsParams" title="Permalink"></a></h3><p><strong>Overview:</strong> Defines parameters for the Normalized Cuts algorithm.</p><pre><code class="language-julia hljs">struct NormalizedCutsParams
    σ_spatial::Float64  # Spatial scale
    σ_feature::Float64  # Feature scale
    min_ncut::Float64  # Threshold for recursive splitting
    max_depth::Int  # Maximum recursion depth
    k_nearest::Int  # Number of nearest neighbors
end</code></pre><h2 id="3.-Constructing-a-Similarity-Graph"><a class="docs-heading-anchor" href="#3.-Constructing-a-Similarity-Graph">3. Constructing a Similarity Graph</a><a id="3.-Constructing-a-Similarity-Graph-1"></a><a class="docs-heading-anchor-permalink" href="#3.-Constructing-a-Similarity-Graph" title="Permalink"></a></h2><h3 id="3.1-Types-of-Similarity-Graphs"><a class="docs-heading-anchor" href="#3.1-Types-of-Similarity-Graphs">3.1 Types of Similarity Graphs</a><a id="3.1-Types-of-Similarity-Graphs-1"></a><a class="docs-heading-anchor-permalink" href="#3.1-Types-of-Similarity-Graphs" title="Permalink"></a></h3><table><tr><th style="text-align: right">Graph Type</th><th style="text-align: right">Description</th><th style="text-align: right">Function</th></tr><tr><td style="text-align: right">ε-neighborhood Graph</td><td style="text-align: right">Connects points within distance ε</td><td style="text-align: right"><code>epsilon_neighborhood_graph</code></td></tr><tr><td style="text-align: right">k-NN Graph</td><td style="text-align: right">Connects each point to k neighbors</td><td style="text-align: right"><code>knn_graph</code></td></tr><tr><td style="text-align: right">Mutual k-NN Graph</td><td style="text-align: right">Connects only mutual k-neighbors</td><td style="text-align: right"><code>mutual_knn_graph</code></td></tr><tr><td style="text-align: right">Fully Connected Graph</td><td style="text-align: right">Connects all points (weighted)</td><td style="text-align: right"><code>fully_connected_graph</code></td></tr></table><h2 id="4.-Implementation-of-Spectral-Clustering"><a class="docs-heading-anchor" href="#4.-Implementation-of-Spectral-Clustering">4. Implementation of Spectral Clustering</a><a id="4.-Implementation-of-Spectral-Clustering-1"></a><a class="docs-heading-anchor-permalink" href="#4.-Implementation-of-Spectral-Clustering" title="Permalink"></a></h2><h3 id="4.1-Computing-the-Graph-Laplacian"><a class="docs-heading-anchor" href="#4.1-Computing-the-Graph-Laplacian">4.1 Computing the Graph Laplacian</a><a id="4.1-Computing-the-Graph-Laplacian-1"></a><a class="docs-heading-anchor-permalink" href="#4.1-Computing-the-Graph-Laplacian" title="Permalink"></a></h3><pre><code class="language-julia hljs">Lsym = compute_normalized_laplacian(W)</code></pre><h3 id="4.2-Eigenvalue-Decomposition"><a class="docs-heading-anchor" href="#4.2-Eigenvalue-Decomposition">4.2 Eigenvalue Decomposition</a><a id="4.2-Eigenvalue-Decomposition-1"></a><a class="docs-heading-anchor-permalink" href="#4.2-Eigenvalue-Decomposition" title="Permalink"></a></h3><pre><code class="language-julia hljs">eigen_decomp = eigen(Symmetric(Lsym))
U = eigen_decomp.vectors[:, 1:k]</code></pre><h3 id="4.3-Clustering-using-k-means"><a class="docs-heading-anchor" href="#4.3-Clustering-using-k-means">4.3 Clustering using k-means</a><a id="4.3-Clustering-using-k-means-1"></a><a class="docs-heading-anchor-permalink" href="#4.3-Clustering-using-k-means" title="Permalink"></a></h3><pre><code class="language-julia hljs">using Clustering
result = kmeans(U&#39;, 3, init=:kmpp)
clusters = result.assignments</code></pre><h2 id="5.-Self-Tuning-Spectral-Clustering"><a class="docs-heading-anchor" href="#5.-Self-Tuning-Spectral-Clustering">5. Self-Tuning Spectral Clustering</a><a id="5.-Self-Tuning-Spectral-Clustering-1"></a><a class="docs-heading-anchor-permalink" href="#5.-Self-Tuning-Spectral-Clustering" title="Permalink"></a></h2><pre><code class="language-julia hljs">W_self_tuning = construct_self_tuning_affinity(X, SelfTuningParams(3, 1.0))
clusters_self = self_tuning_spectral_clustering(W_self_tuning, 3)</code></pre><h2 id="6.-Image-Segmentation-using-Normalized-Cuts"><a class="docs-heading-anchor" href="#6.-Image-Segmentation-using-Normalized-Cuts">6. Image Segmentation using Normalized Cuts</a><a id="6.-Image-Segmentation-using-Normalized-Cuts-1"></a><a class="docs-heading-anchor-permalink" href="#6.-Image-Segmentation-using-Normalized-Cuts" title="Permalink"></a></h2><pre><code class="language-julia hljs">params = NormalizedCutsParams(σ_spatial=10.0, σ_feature=0.1)
W_image = compute_image_affinity(spatial_coords, features, params)
ncut_value = compute_ncut_value(W_image, partition)
segments = recursive_ncut(W_image, params)
segments, W_final = normalized_cuts_segmentation(spatial_coords, features, params)</code></pre><h2 id="7.-Conclusion"><a class="docs-heading-anchor" href="#7.-Conclusion">7. Conclusion</a><a id="7.-Conclusion-1"></a><a class="docs-heading-anchor-permalink" href="#7.-Conclusion" title="Permalink"></a></h2><p>This tutorial has provided an overview of the theory behind Spectral Clustering and its implementation in Julia.</p><table><tr><th style="text-align: right">Task</th><th style="text-align: right">Function</th></tr><tr><td style="text-align: right">Construct Similarity Graph</td><td style="text-align: right"><code>construct_similarity_graph</code></td></tr><tr><td style="text-align: right">k-NN Graph</td><td style="text-align: right"><code>knn_graph</code></td></tr><tr><td style="text-align: right">Mutual k-NN Graph</td><td style="text-align: right"><code>mutual_knn_graph</code></td></tr><tr><td style="text-align: right">Fully Connected Graph</td><td style="text-align: right"><code>fully_connected_graph</code></td></tr><tr><td style="text-align: right">Compute Normalized Laplacian</td><td style="text-align: right"><code>compute_normalized_laplacian</code></td></tr><tr><td style="text-align: right">Spectral Clustering</td><td style="text-align: right"><code>spectral_clustering</code></td></tr><tr><td style="text-align: right">Self-Tuning Clustering</td><td style="text-align: right"><code>self_tuning_spectral_clustering</code></td></tr><tr><td style="text-align: right">Image Segmentation</td><td style="text-align: right"><code>normalized_cuts_segmentation</code></td></tr></table><p>Use this guide to explore advanced clustering techniques and image segmentation research.</p></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.10.2 on <span class="colophon-date" title="Monday 28 April 2025 15:49">Monday 28 April 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
